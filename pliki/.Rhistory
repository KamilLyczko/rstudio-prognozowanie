day_in_year <- day_in_year + month_days[i]
}
}
day_of_year_number("2016-01-02")
day_of_year_number <- function(date) {
date <- as.Date(date)
month_number <- as.numeric(format(date, "%m"))
day_number <- as.numeric(format(date, "%d"))
year_number <- as.numeric(format(date, "%y"))
month_days <- c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
day_in_year <- day_number
for (i in 1:month_number) {
if(i==month_number)
break
day_in_year <- day_in_year + month_days[i]
}
return(day_in_year)
}
day_of_year_number("2016-01-02")
day_of_year_number("2014-06-01")
day_of_year_number("2014-12-12")
day_of_year_number("2014-12-31")
day_of_year_number("2014-01-01")
!5
!0
day_of_year_number <- function(date) {
date <- as.Date(date)
month_number <- as.numeric(format(date, "%m"))
day_number <- as.numeric(format(date, "%d"))
year_number <- as.numeric(format(date, "%y"))
month_days <- c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30);
day_in_year <- day_number
for (i in 1:month_number) {
if(i==month_number)
break
day_in_year <- day_in_year + month_days[i]
}
if (!year_number %% 4 && month_number > 2)
day_in_year <- day_in_year + 1
return(day_in_year)
}
day_of_year_number("2013-03-01")
day_of_year_number("2012-03-01")
day_of_year_number("2012-0")
rm(inds)
rm(fc)
rm(month_days)
View(day_of_year_number)
View(data)
rm(data)
View(day_of_year_number)
save.image("D:/Studia/Praca dyplomowa/pliki/day_of_year_number_function.RData")
setwd("D:/Studia/Praca dyplomowa/R/rstudio-prognozowanie/pliki")
load("D:/Studia/Praca dyplomowa/R/rstudio-prognozowanie/pliki/.RData")
?axis
?plot
a <- c(as.Date("2021-05-04") : as.Date("2021-05-10"))
a
as.Date(a[1])
a <- data$date
a
window(a, end = 3)
window(a, start = 590, end = 597)
?axis
#wykresy czasowe
plot(confirmed1, main = "Wykres czasowy zakażeń do I fali", xlab = "tydzień", ylab = "liczba zakażeń") +
axis(labels = data$date)
#wykresy czasowe
plot(confirmed1, main = "Wykres czasowy zakażeń do I fali", xlab = "tydzień", ylab = "liczba zakażeń") +
axis(side = 1, labels = data$date)
#wykresy czasowe
plot(confirmed1, main = "Wykres czasowy zakażeń do I fali", xlab = "tydzień", ylab = "liczba zakażeń") +
axis(1, data$date, data$date)
plot(confirmed4, main = "Wykres czasowy zakażeń do IV fali", xlab = "tydzień", ylab = "liczba zakażeń") +
axis(1, data$date, data$date)
c(data$date)
plot(confirmed4, main = "Wykres czasowy zakażeń do IV fali", xlab = "tydzień", ylab = "liczba zakażeń") +
axis(1, c(data$date), c(data$date))
plot(data$confirmed~data$date)
plot(data$confirmed~data$tests)
plot(as.Numeric(data$confirmed)~data$date)
plot(as.numeric(data$confirmed)~data$date)
plot(y = as.numeric(data$confirmed), x = data$date)
plot(deaths1, main = "Wykres czasowy śmierci do I fali", xlab = "tydzień", ylab = "liczba śmierci")
plot(y = as.numeric(data$confirmed), x = data$date)
help("plot.ts")
library(forecast)
library(ggplot2)
library(expsmooth)
library(GGally)
library(pdp)
library(stats)
ggplot(data = data, aes(date, confirmed)) + geom_line()
help("autoplot")
ggplot(data = data, aes(date, confirmed)) + geom_line() + scale_x_date(format = "%b %d", major =  "1 day")
ggplot(data = data, aes(date, confirmed)) + geom_line()
ggplot(data = data, aes(date, confirmed)) + geom_line()
ggplot(data = data, aes(c(date), confirmed)) + geom_line()
package(zoo)
library(zoo)
plot(zoo(confirmed,data$date))
ggplot(data = data, aes(date, confirmed)) + geom_line()
View(data)
ggplot(data = data, aes(date, confirmed)) + geom_line() + scale_x_date(date_labels = "%d-%m-%Y")
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, data_new$dates, format(data_new$dates, "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, data$date, format(data$date, "%Y-%m-%d"))
?axis
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, c(data$date[1], data$date[300], data$date[600]), format(c(data$date[1], data$date[300], data$date[600]), "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, c(data$date[1], data$date[50], data$date[600]), format(c(data$date[1], data$date[300], data$date[600]), "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, c(data$date[1], data$date[50], data$date[600]), format(c(data$date[1], data$date[50], data$date[600]), "%Y-%m-%d"))
data$date[1]
data$date[1] + 5
data$date[1] + 60
c(seq(data$date[1], data$date[600], 30))
test_lab <- c(seq(data$date[1], data$date[600], 30))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"))
?plot
plot(data$date, confirmed, type = "l", xaxt = "n", las = 3)
axis(1, test_lab, format(test_lab, "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n", las = 2)
axis(1, test_lab, format(test_lab, "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n") + theme(axis.text.x = element_text(angle = 60, hjust = 1))
axis(1, test_lab, format(test_lab, "%Y-%m-%d"))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"))  + theme(axis.text.x = element_text(angle = 60, hjust = 1))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 3)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 4)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2)
#wykresy czasowe
plot(confirmed1, main = "Wykres czasowy zakażeń do I fali", xlab = "tydzień", ylab = "liczba zakażeń")
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2)
?theme
plot(data$date, confirmed, type = "l", xaxt = "n", cex = 0.5)
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2)
?axis
plot(data$date, confirmed, type = "l", xaxt = "n", cex.axis = 0.5)
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.5)
plot(data$date, confirmed, type = "l", xaxt = "n", xlab = "")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.5)
plot(data$date, confirmed, type = "l", xaxt = "n", xlab = "")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, cex.pos = 2)
?par
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 2, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 0, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(4, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp[1] = c(3, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, mgp = c(3, 1, 0))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7, srt = 35)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
text(srt = 35)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, labels = FALSE, las = 2, cex.axis = 0.7)
text(x = test_lab, labels = format(test_lab, "%Y-%m-%d"), srt = 35)
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
#wykresy czasowe
plot(confirmed1, main = "Wykres czasowy zakażeń do I fali", xlab = "tydzień", ylab = "liczba zakażeń")
?plot
test_lab <- c(seq(data$date[1], data$date[600], 30))
plot(data$date, confirmed, xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
test_lab <- c(seq(data$date[1], data$date[600], 30))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
?scale_x_date
ggplot(data = data, aes(date, confirmed)) + geom_line() + scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y")
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdow(angle = 45))
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45))
library(ggtext)
install.packages("ggtext")
library(ggtext)
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45))
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45, hjust = 1))
test_lab <- c(seq(data$date[1], data$date[600], 30))
plot(data$date, confirmed, type = "l", xaxt = "n")
axis(1, test_lab, format(test_lab, "%Y-%m-%d"), las = 2, cex.axis = 0.7)
?autoplot
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
confirmed_time_plots <- list()
deaths_time_plots <- list()
confirmed_season_plots <- list()
deaths_season_plots <- list()
i <- 1
begin <- 1;
finish <- begin + 99
while(begin < length(data[, 1])) {
if(finish > length(data[, 1]))
finish = length(data[, 1])
confirmed_ts <- window(confirmed, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
deaths_ts <- window(deaths, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
title_time <- paste(data$date[begin], " do ", data$date[finish])
confirmed_time_plots[[i]] <- autoplot(confirmed_ts, main = paste("Wykres czasowy zakażeń od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
theme(plot.title = element_text(size = 10))
deaths_time_plots[[i]] <- autoplot(deaths_ts, main = paste("Wykres czasowy śmierci od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
theme(plot.title = element_text(size = 10))
confirmed_season_plots[[i]] <- ggseasonplot(confirmed_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy zakażeń od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba zakażeń")
deaths_season_plots[[i]] <- ggseasonplot(deaths_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy śmierci od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba śmierci")
begin <- finish + 1
finish <- begin + 99
i <- i + 1
}
grid.arrange(grobs = confirmed_time_plots, ncol = 2)
grid.arrange(grobs = deaths_time_plots, ncol = 2)
grid.arrange(grobs = confirmed_season_plots, ncol = 2)
grid.arrange(grobs = deaths_season_plots, ncol = 2)
rm(begin, finish, i, x_values, title_time, confirmed_time_plots, confirmed_season_plots, deaths_time_plots, deaths_season_plots,
confirmed_ts, deaths_ts)
autoplot(aes(data$date, data$confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
autoplot(x = data$date, y = data$confirmed, main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(aes(data$date, confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
?ggplot
ggplot(mapping = aes(data$date, confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(mapping = aes(data$date, data?confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(mapping = aes(data$date, data$confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data = data, aes(data$date, data$confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data = data, aes(date, confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data = data, aes(date, confirmed), main = "Wykres czasowy zakażeń od ",
xlab = "tydzień", ylab = "liczba zakażeń") +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
confirmed_time_plots <- list()
deaths_time_plots <- list()
confirmed_season_plots <- list()
deaths_season_plots <- list()
i <- 1
begin <- 1;
finish <- begin + 99
while(begin < length(data[, 1])) {
if(finish > length(data[, 1]))
finish = length(data[, 1])
confirmed_ts <- window(confirmed, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
deaths_ts <- window(deaths, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
date_window <- window(data$date, start = begin, end = finish)
title_time <- paste(data$date[begin], " do ", data$date[finish])
confirmed_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = confirmed_ts),
aes(x, y), main = paste("Wykres czasowy zakażeń od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
deaths_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = deaths_ts),
aes(x, y), main = paste("Wykres czasowy śmierci od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
confirmed_season_plots[[i]] <- ggseasonplot(confirmed_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy zakażeń od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba zakażeń")
deaths_season_plots[[i]] <- ggseasonplot(deaths_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy śmierci od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba śmierci")
begin <- finish + 1
finish <- begin + 99
i <- i + 1
}
grid.arrange(grobs = confirmed_time_plots, ncol = 2)
grid.arrange(grobs = deaths_time_plots, ncol = 2)
grid.arrange(grobs = confirmed_season_plots, ncol = 2)
grid.arrange(grobs = deaths_season_plots, ncol = 2)
rm(begin, finish, i, x_values, title_time, confirmed_time_plots, confirmed_season_plots, deaths_time_plots, deaths_season_plots,
confirmed_ts, deaths_ts, date_window)
ggplot(data = data.frame(x = date_window, y = confirmed_ts), aes(x, y), main = paste("Wykres czasowy zakażeń od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data, aes(date, confirmed), main = paste("Wykres czasowy zakażeń od ", title_time),
xlab = "tydzień", ylab = "liczba zakażeń") +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
labs(title = "Wykres czasowy zakażeń od ", x = "x", y = "y") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
confirmed_time_plots <- list()
deaths_time_plots <- list()
confirmed_season_plots <- list()
deaths_season_plots <- list()
i <- 1
begin <- 1;
finish <- begin + 99
while(begin < length(data[, 1])) {
if(finish > length(data[, 1]))
finish = length(data[, 1])
confirmed_ts <- window(confirmed, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
deaths_ts <- window(deaths, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
date_window <- window(data$date, start = begin, end = finish)
x_labs <- c(seq(date_window[1], date_window[length(date_window)], 20))
title_time <- paste(data$date[begin], " do ", data$date[finish])
confirmed_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = confirmed_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy zakażeń od ", title_time), x = "Data", y = "Liczba zakażeń") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
deaths_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = deaths_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = test_lab, labels = test_lab, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy śmierci od ", title_time), x = "Data", y = "Liczba śmierci") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
confirmed_season_plots[[i]] <- ggseasonplot(confirmed_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy zakażeń od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba zakażeń")
deaths_season_plots[[i]] <- ggseasonplot(deaths_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy śmierci od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba śmierci")
begin <- finish + 1
finish <- begin + 99
i <- i + 1
}
grid.arrange(grobs = confirmed_time_plots, ncol = 2)
grid.arrange(grobs = deaths_time_plots, ncol = 2)
grid.arrange(grobs = confirmed_season_plots, ncol = 2)
grid.arrange(grobs = deaths_season_plots, ncol = 2)
rm(begin, finish, i, x_values, title_time, confirmed_time_plots, confirmed_season_plots, deaths_time_plots, deaths_season_plots,
confirmed_ts, deaths_ts, date_window, x_labs)
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
confirmed_time_plots <- list()
deaths_time_plots <- list()
confirmed_season_plots <- list()
deaths_season_plots <- list()
i <- 1
begin <- 1;
finish <- begin + 99
while(begin < length(data[, 1])) {
if(finish > length(data[, 1]))
finish = length(data[, 1])
confirmed_ts <- window(confirmed, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
deaths_ts <- window(deaths, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
date_window <- window(data$date, start = begin, end = finish)
x_labs <- c(seq(date_window[1], date_window[length(date_window)], 20))
title_time <- paste(data$date[begin], " do ", data$date[finish])
confirmed_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = confirmed_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy zakażeń od ", title_time), x = "Data", y = "Liczba zakażeń") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
deaths_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = deaths_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy śmierci od ", title_time), x = "Data", y = "Liczba śmierci") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
confirmed_season_plots[[i]] <- ggseasonplot(confirmed_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy zakażeń od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba zakażeń")
deaths_season_plots[[i]] <- ggseasonplot(deaths_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy śmierci od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba śmierci")
begin <- finish + 1
finish <- begin + 99
i <- i + 1
}
grid.arrange(grobs = confirmed_time_plots, ncol = 2)
grid.arrange(grobs = deaths_time_plots, ncol = 2)
grid.arrange(grobs = confirmed_season_plots, ncol = 2)
grid.arrange(grobs = deaths_season_plots, ncol = 2)
rm(begin, finish, i, x_values, title_time, confirmed_time_plots, confirmed_season_plots, deaths_time_plots, deaths_season_plots,
confirmed_ts, deaths_ts, date_window, x_labs)
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
confirmed_time_plots <- list()
deaths_time_plots <- list()
confirmed_season_plots <- list()
deaths_season_plots <- list()
i <- 1
begin <- 1;
finish <- begin + 99
while(begin < length(data[, 1])) {
if(finish > length(data[, 1]))
finish = length(data[, 1])
confirmed_ts <- window(confirmed, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
deaths_ts <- window(deaths, start = weekly_freq_day_number(begin), end = weekly_freq_day_number(finish))
date_window <- window(data$date, start = begin, end = finish)
x_labs <- c(seq(date_window[1], date_window[length(date_window)], 20))
x_labs[length(x_labs) + 1] <- date_window[length(date_window)]
title_time <- paste(data$date[begin], " do ", data$date[finish])
confirmed_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = confirmed_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy zakażeń od ", title_time), x = "Data", y = "Liczba zakażeń") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
deaths_time_plots[[i]] <- ggplot(data = data.frame(x = date_window, y = deaths_ts), aes(x, y)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
labs(title = paste("Wykres czasowy śmierci od ", title_time), x = "Data", y = "Liczba śmierci") +
theme(plot.title = element_text(size = 10), axis.text.x = element_markdown(angle = 45, hjust = 1))
confirmed_season_plots[[i]] <- ggseasonplot(confirmed_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy zakażeń od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba zakażeń")
deaths_season_plots[[i]] <- ggseasonplot(deaths_ts, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
theme(plot.title = element_text(size = 10)) +
ggtitle(paste("Wykres sezonowy śmierci od ", title_time)) + xlab("dzień tygodnia") + ylab("liczba śmierci")
begin <- finish + 1
finish <- begin + 99
i <- i + 1
}
grid.arrange(grobs = confirmed_time_plots, ncol = 2)
grid.arrange(grobs = deaths_time_plots, ncol = 2)
grid.arrange(grobs = confirmed_season_plots, ncol = 2)
grid.arrange(grobs = deaths_season_plots, ncol = 2)
rm(begin, finish, i, x_values, title_time, confirmed_time_plots, confirmed_season_plots, deaths_time_plots, deaths_season_plots,
confirmed_ts, deaths_ts, date_window, x_labs)
rm(test_lab)
rm(a)
x_labs <- c(seq(data$date[1], data$date[length(data$date)], 30))
x_labs[length(x_labs) + 1] <- data$date[length(data$date)]
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45, hjust = 1))
x_labs <- c(seq(data$date[1], data$date[length(data$date)], 30))
x_labs[length(x_labs) + 1] <- data$date[length(data$date)]
ggplot(data = data, aes(date, confirmed)) +
geom_line() +
labs(title = "Wykres czasowy liczby zakażeń", x = "data", y = "liczba zakażeń") +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data = data, aes(date, deaths)) +
geom_line() +
labs(title = "Wykres czasowy liczby śmierci", x = "data", y = "liczba śmierci") +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45, hjust = 1))
ggplot(data = data, aes(date, tests)) +
geom_line() +
labs(title = "Wykres czasowy liczby testów", x = "data", y = "liczba testóW") +
scale_x_date(breaks = x_labs, labels = x_labs, date_labels = "%d-%m-%Y") +
theme(axis.text.x = element_markdown(angle = 45, hjust = 1))
#wykresy sezonowe
ggseasonplot(confirmed1, year.labels = TRUE, year.labels.left = TRUE) +
ggtitle("Wykres sezonowy zakażeń do I fali") + xlab("dzień tygodnia") + ylab("liczba zakażeń")
ggseasonplot(confirmed1, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
ggtitle("Wykres sezonowy zakażeń do I fali") + xlab("dzień tygodnia") + ylab("liczba zakażeń")
#wykresy sezonowe
x_values <- c("Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob")
ggseasonplot(confirmed1, year.labels = TRUE, year.labels.left = TRUE, season.labels = x_values) +
ggtitle("Wykres sezonowy zakażeń do I fali") + xlab("dzień tygodnia") + ylab("liczba zakażeń")
rm(x_labs, x_values)
